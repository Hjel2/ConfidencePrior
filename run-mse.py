from src.experiments import coreset_vcl

epochs = 10
coreset_method='random'
device='cpu'
n_tasks=10
loss_fn='mse'
std=0.1
logit_std=0.3162

coreset_vcl(
    epochs=epochs,
    coreset_size=0,
    coreset_method=None,
    device=device,
    n_tasks=n_tasks,
    loss_fn=loss_fn,
    std=std,
    logit_std=logit_std,
)

# 1 epoch
# 
# std = 0.05
# [
# [0.2836], 
# [0.3959, 0.2530], 
# [0.5003, 0.3654, 0.2318], 
# [0.6129, 0.4717, 0.3574, 0.2422], 
# [0.6988, 0.5710, 0.4439, 0.3400, 0.2224], 
# [0.7748, 0.6639, 0.5414, 0.4265, 0.3335, 0.3517], 
# [0.8565, 0.7059, 0.6070, 0.4864, 0.3891, 0.4659, 0.2411], 
# [0.8985, 0.7538, 0.6667, 0.5372, 0.4566, 0.5221, 0.3410, 0.2683], 
# [0.9364, 0.8131, 0.7223, 0.5941, 0.5311, 0.6080, 0.3559, 0.3564, 0.2237], 
# [0.9597, 0.8616, 0.7768, 0.6434, 0.6251, 0.6417, 0.4820, 0.4249, 0.3455, 0.2239]]

# std = 0.1
# [
# [0.3140], 
# [0.4284, 0.2648], 
# [0.5200, 0.3839, 0.2436], 
# [0.6360, 0.5098, 0.3669, 0.2424], 
# [0.7412, 0.5958, 0.4635, 0.3290, 0.2302], 
# [0.8401, 0.6884, 0.5911, 0.4902, 0.4381, 0.3233], 
# [0.8874, 0.7223, 0.6157, 0.5382, 0.4707, 0.4169, 0.2235], 
# [0.9110, 0.7654, 0.6935, 0.5874, 0.5223, 0.4661, 0.3055, 0.2302], 
# [0.9263, 0.8043, 0.7501, 0.6422, 0.5876, 0.5247, 0.3351, 0.3008, 0.2190], 
# [0.9467, 0.8630, 0.7587, 0.6821, 0.6562, 0.5924, 0.4186, 0.3701, 0.3065, 0.2136]]

# std = 0.25
# [
# [0.4121], 
# [0.4838, 0.3160], 
# [0.5283, 0.3827, 0.3052], 
# [0.6164, 0.4874, 0.3768, 0.3060], 
# [0.7035, 0.5466, 0.4551, 0.3461, 0.2869], 
# [0.7815, 0.6008, 0.5479, 0.4464, 0.3586, 0.2940], 
# [0.8339, 0.6581, 0.5899, 0.5406, 0.4338, 0.3631, 0.2850], 
# [0.8643, 0.6978, 0.6520, 0.5847, 0.4935, 0.4354, 0.3325, 0.2886], 
# [0.8892, 0.7127, 0.7106, 0.6580, 0.5592, 0.4895, 0.3546, 0.3423, 0.2860], 
# [0.9195, 0.7533, 0.7216, 0.6843, 0.6132, 0.5271, 0.4051, 0.3961, 0.3252, 0.2780]]

# 5 epochs
# std = 0.05
# [
# [0.1662], 
# [0.2701, 0.1372], 
# [0.3890, 0.2181, 0.1331], 
# [0.5699, 0.4076, 0.2672, 0.1617], 
# [0.6803, 0.5301, 0.3262, 0.1946, 0.1543], 
# [0.7908, 0.7276, 0.4872, 0.3555, 0.3244, 0.2068], 
# [0.8286, 0.7657, 0.5038, 0.3631, 0.3303, 0.2699, 0.1872], 
# [0.8194, 0.8371, 0.5861, 0.4806, 0.4226, 0.3583, 0.2935, 0.2015], 
# [0.8289, 0.8793, 0.6113, 0.4953, 0.4353, 0.3741, 0.2831, 0.2485, 0.1917], 
# [0.9089, 0.9674, 0.6808, 0.5789, 0.4671, 0.4024, 0.3138, 0.2843, 0.2297, 0.1830]]

# std = 0.1
# [
# [0.2067], 
# [0.2650, 0.1685], 
# [0.3296, 0.2365, 0.1704], 
# [0.4115, 0.3075, 0.2468, 0.1795], 
# [0.4917, 0.3584, 0.2898, 0.2009, 0.1738], 
# [0.5673, 0.3700, 0.3268, 0.2290, 0.2118, 0.1875], 
# [0.6156, 0.4163, 0.3328, 0.3104, 0.2603, 0.2229, 0.1994], 
# [0.6349, 0.4341, 0.3582, 0.3612, 0.2999, 0.2712, 0.2100, 0.2003], 
# [0.6677, 0.4448, 0.3882, 0.4125, 0.3388, 0.3138, 0.2401, 0.2258, 0.1983], 
# [0.7088, 0.5035, 0.4279, 0.4653, 0.3889, 0.3295, 0.2834, 0.2536, 0.2275, 0.2019]]

# std = 0.2
# [
# [0.2885], 
# [0.3089, 0.2549], 
# [0.3366, 0.2785, 0.2445], 
# [0.3776, 0.2997, 0.2766, 0.2496], 
# [0.4248, 0.3199, 0.2971, 0.2667, 0.2529], 
# [0.4700, 0.3308, 0.3375, 0.3008, 0.2817, 0.2550], 
# [0.4951, 0.3475, 0.3580, 0.3657, 0.3115, 0.2768, 0.2656], 
# [0.5166, 0.3629, 0.3830, 0.3859, 0.3488, 0.3007, 0.2837, 0.2647], 
# [0.5448, 0.3657, 0.4045, 0.4114, 0.3737, 0.3107, 0.3149, 0.2838, 0.2685], 
# [0.6017, 0.4081, 0.4390, 0.4239, 0.4156, 0.3350, 0.3506, 0.3134, 0.3008, 0.2725]]

# 10 epochs
# std = 0.1
# [
# [0.1780], 
# [0.1995, 0.1592], 
# [0.2329, 0.1852, 0.1687], 
# [0.2811, 0.2006, 0.1893, 0.1729], 
# [0.3349, 0.2333, 0.2132, 0.1913, 0.1837], 
# [0.3623, 0.2457, 0.2559, 0.2199, 0.2030, 0.1850], 
# [0.3897, 0.2675, 0.2775, 0.2506, 0.2250, 0.2123, 0.1799], 
# [0.3977, 0.2852, 0.3179, 0.2891, 0.2634, 0.2532, 0.1995, 0.1854], 
# [0.4180, 0.3048, 0.3442, 0.3196, 0.2989, 0.2831, 0.2218, 0.2164, 0.1859], 
# [0.4699, 0.3366, 0.3800, 0.3293, 0.3318, 0.3010, 0.2846, 0.2365, 0.2191, 0.1946]]

# std = 0.2
# [
# [0.2757], 
# [0.2899, 0.2551], 
# [0.3112, 0.2716, 0.2662], 
# [0.3228, 0.2836, 0.2926, 0.2713], 
# [0.3521, 0.2943, 0.3084, 0.2840, 0.2792], 
# [0.3655, 0.3085, 0.3340, 0.3090, 0.2937, 0.2763],
# [0.3871, 0.3293, 0.3555, 0.3510, 0.3248, 0.3041, 0.2855], 
# [0.4002, 0.3439, 0.3889, 0.3808, 0.3445, 0.3289, 0.2929, 0.2779], 
# [0.4213, 0.3402, 0.4092, 0.3882, 0.3665, 0.3504, 0.3116, 0.3042, 0.2881], 
# [0.4285, 0.3598, 0.4270, 0.4035, 0.3947, 0.3748, 0.3301, 0.3318, 0.3121, 0.2786]]

# 20 epochs

# std = 0.1
# [
# [0.1642], 
# [0.1827, 0.1623], 
# [0.2041, 0.1789, 0.1739], 
# [0.2306, 0.2183, 0.1951, 0.1867], 
# [0.2778, 0.2602, 0.2309, 0.2363, 0.1860], 
# [0.3086, 0.2739, 0.2838, 0.2602, 0.2103, 0.2004], 
# [0.3225, 0.3014, 0.2946, 0.3073, 0.2646, 0.2276, 0.1925], 
# [0.3534, 0.3178, 0.3240, 0.3307, 0.2975, 0.2474, 0.2240, 0.2073], 
# [0.3807, 0.3394, 0.3312, 0.3460, 0.3360, 0.2833, 0.2440, 0.2438, 0.2134], 
# [0.4383, 0.4092, 0.3861, 0.3745, 0.3620, 0.3238, 0.2864, 0.2636, 0.2384, 0.2135]]


# 5 epochs

# coreset 200

# std = 0.2
# [
# [0.2884], 
# [0.3033, 0.2465], 
# [0.3189, 0.2773, 0.2494], 
# [0.3503, 0.2958, 0.2643, 0.2485], 
# [0.3816, 0.2969, 0.2807, 0.2601, 0.2547], 
# [0.4230, 0.3120, 0.3143, 0.2918, 0.2736, 0.2684], 
# [0.4447, 0.3447, 0.3224, 0.3168, 0.2903, 0.3009, 0.2676], 
# [0.4632, 0.3693, 0.3352, 0.3495, 0.3167, 0.3299, 0.2804, 0.2626], 
# [0.4878, 0.3764, 0.3621, 0.3591, 0.3434, 0.3311, 0.2867, 0.2952, 0.2801], 
# [0.5300, 0.3917, 0.3768, 0.3627, 0.3674, 0.3599, 0.3131, 0.3083, 0.2896, 0.2684]]

# TODO coreset >0.2
# TODO more epochs?

for coreset_size in (200, 400, 1000, 2500, 5000):
    coreset_vcl(
        epochs=epochs,
        coreset_size=coreset_size,
        coreset_method=coreset_method,
        device=device,
        n_tasks=n_tasks,
        loss_fn=loss_fn,
        std=std,
        logit_std=logit_std
    )
